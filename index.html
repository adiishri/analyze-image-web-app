<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Image Recognition Web Application using the Azure Cognitive Services</title>
</head>
<body>
  <h1>Image Recognition Web App</h1>
  <input type="file" id="imageFile" accept="image/*">
  <button onclick="recognizeImage()">Recognize</button>
  <br>
  <img id="imageDisplay" style="max-width: 500px">
  <div id="descriptionDisplay"></div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    function recognizeImage() {
      var formData = new FormData();
      var fileInput = document.getElementById('imageFile');
      formData.append('image', fileInput.files[0]);

      $.ajax({
        url: 'https://analyzeimage-leivadaros.cognitiveservices.azure.com/vision/v3.2/analyze?visualFeatures=Description',
        beforeSend: function(xhrObj){
          xhrObj.setRequestHeader("Content-Type","application/octet-stream");
          xhrObj.setRequestHeader("Ocp-Apim-Subscription-Key","a03ab615821a4f78ba4afce0e0c71ede");
        },
        type: "POST",
        data: fileInput.files[0],
        processData: false
      })
      .done(function(data) {
        // Display the image
        var imageURL = URL.createObjectURL(fileInput.files[0]);
        $('#imageDisplay').attr('src', imageURL);

        // Display the description
        var description = data.description;
        var descriptionText = "<p><strong>Description: </strong>" + description.captions[0].text + "</p>";
        descriptionText += "<p><strong>Tags: </strong>" + description.tags.join(", ") + "</p>";
        $('#descriptionDisplay').html(descriptionText);
      })
      .fail(function(jqXHR, textStatus, errorThrown) {
        alert('Error: ' + textStatus);
      });
    }
  </script>
  <footer>
    <a href="https://github.com/paraskevasleivadaros/analyze-image-web-app">Source code</a>
  </footer>  
</body>
</html>
